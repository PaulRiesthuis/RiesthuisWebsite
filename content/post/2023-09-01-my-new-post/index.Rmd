---
title: my new post
author: ''
date: '2023-09-01'
slug: my-new-post
categories: []
tags: []
subtitle: ''
summary: ''
authors: []
lastmod: '2023-09-01T13:41:41+02:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output:
    html_document:     
    fig_width: 10
    fig_height: 8
    df_print: paged
    code_folding: hide
    theme: flatly
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

```{css sidenote, echo = FALSE}
.sidenote, .marginnote { 
  float: right;
  clear: right;
  margin-right: -60%;
  width: 57%;         # best between 50% and 60%
  margin-top: 0;
  margin-bottom: 0;
  font-size: 1.1rem;
  line-height: 1.3;
  vertical-align: baseline;
  position: relative;
  }
```
---


```{r setup, warning=FALSE, message=FALSE}
library(readxl)
library(tidyverse)
library(ggforce)
library(patchwork)
library(ggridges)
library(lcsm)
library(data.table)
library(gt)
library(psych)
```

In this R Markdown file, we present the data analysis of the study examining the smallest effect size of interest among legal professionals

# Data Preparation
<button id="showButton">Show Explanation</button>

<div id="contentContainer" style="display:none;">
- Load the data 
- Transform in dataframe. 
- First line is skipped due to data format of Qualtrics.
- Rename variable of background job and current job for data analysis.
- Remove participants that did not complete the study (progress is not 100%)
- Change "never" Response to "12" to include in analyses. Hence 12 = no amount of errors would lead to a certain legal decision.
- Add participant column
- Rename long variable names into x1-x18
- Rename/group occupations (beroep)
- Add columns wherein participants are grouped based on their response to the first legal decision for each scenario (low, medium-low, medium-high, high amount of memory errors).
- Put the "group" variable in the correct order
- Put the "beroep"(occupation) in the correct order
</div>
<script>
document.getElementById("showButton").addEventListener("click", function() {
  var contentContainer = document.getElementById("contentContainer");
  if (contentContainer.style.display === "none") {
    contentContainer.style.display = "block";
  } else {
    contentContainer.style.display = "none";
  }
});
</script>

```{r, message= FALSE }
dat_orignal <- read_xlsx("Raw_Data.xlsx",  skip = 1)
dat_orignal <- as.data.frame(dat_orignal)
setnames(dat_orignal, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_orignal, "Wat is uw huidige beroep? - Selected Choice", "beroep")
dat_orignal <- subset(dat_orignal,dat_orignal$Progress==100)
dat_orignal$participants <- seq(1,295,1)
names(dat_orignal)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_orignal <- dat_orignal %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))
dat_orignal <- dat_orignal %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_orignal <- dat_orignal %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_orignal <- dat_orignal %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))
dat_orignal$group1  = factor(dat_orignal$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_orignal$group2  = factor(dat_orignal$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_orignal$group3  = factor(dat_orignal$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_orignal$beroep  = factor(dat_orignal$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))

```

## Scenario + Variables of interest + Legal decisions
<button id="showButton1">Show Explanation</button>

<div id="contentContainer1" style="display:none;">
- Presented scenario = Consider the following case of the People v. S.W.C. (2012). S.W.C. is charged with unarmed robbery. The police obtained incriminating evidence from one of the adult eyewitnesses of the robbery who stated in an initial interview that they saw S.W.C. at the scene of a crime wearing a *blue jacket*. Video footage confirmed that S.W.C. was wearing a blue jacket 15 minutes before the crime occurred. However, during a second interview, the eyewitness *mistakenly remembers and reports* that S.W.C. was actually wearing a *green jacket*. 
- *Three different memory errors (scenarios)*:
  + Scenario 1: Misremember colour jacket
  + Scenario 2: Misremember entire new detail (i.e., yellow hat)
  + Scenario 3: Misremember entire new incriminating detail (i.e., black gun)
- For each scenario they are asked 6 questions
  + Question 1 - In your opinion, how many of these errors in an eyewitness account is sufficient to consider the eyewitness testimony unreliable 
  + Question 2 - In your opinion, how many of these errors in an eyewitness account is sufficient to consider the eyewitness testimony inadmissible 
  + Question 3 - In your opinion, how many of these errors in an eyewitness account would generally lead you to challenge the admissibility of the witness? 
  + Question 4 - In your opinion, how many of these errors in an eyewitness account would make a judge in your jurisdiction rule the eyewitness’ evidence inadmissible? 
  + Question 5 - In your opinion, how many of these errors in an eyewitness account would it take for you to consider retaining an expert witness to inform the factfinder about the functioning of human memory?
  + Question 6 - In your opinion, how many of these errors in an eyewitness account would generally cause the average person to reduce the weight they place on the eyewitness’ evidence? 

  
- *Response option:* Slider from 0 – 10 errors; extra option = No decision no matter how many errors.

- *Dependent variables:*
  + x1    = Scenario 1  -   Question 1
  + x2    = Scenario 1  -   Question 2
  + x3    = Scenario 1  -   Question 3
  + x4    = Scenario 1  -   Question 4
  + x5    = Scenario 1  -   Question 5
  + x6    = Scenario 1  -   Question 6
  + x7    = Scenario 2  -   Question 1
  + x8    = Scenario 2  -   Question 2
  + x9    = Scenario 2  -   Question 3
  + x10   = Scenario 2  -   Question 4
  + x11   = Scenario 2  -   Question 5
  + x12   = Scenario 2  -   Question 6
  + x13   = Scenario 3  -   Question 1
  + x14   = Scenario 3  -   Question 2
  + x15   = Scenario 3  -   Question 3
  + x16   = Scenario 3  -   Question 4
  + x17   = Scenario 3  -   Question 5
  + x18   = Scenario 3  -   Question 6
  
</div>
<script>
document.getElementById("showButton1").addEventListener("click", function() {
  var contentContainer1 = document.getElementById("contentContainer1");
  if (contentContainer1.style.display === "none") {
    contentContainer1.style.display = "block";
  } else {
    contentContainer1.style.display = "none";
  }
});
</script>

# Data Analysis - Summary Statistics
First, analyses are run on all participants together with no strict exclusion criteria.
## Summary Statistics
First, let's create a table to examine the summary statistics.

<button id="showButton2">Show Table</button>

<div id="contentContainer2" style="display:none;">
```{r}
dat_table <- subset(dat_orignal, select = c(x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))
describe(dat_table, fast = FALSE)
```
</div>
<script>
document.getElementById("showButton2").addEventListener("click", function() {
  var contentContainer2 = document.getElementById("contentContainer2");
  if (contentContainer2.style.display === "none") {
    contentContainer2.style.display = "block";
  } else {
    contentContainer2.style.display = "none";
  }
});
</script>

## Summary Statistics grouped by occupation

<button id="showButton3">Show Table</button>

<div id="contentContainer3" style="display:none;">
```{r, warning = FALSE}
dat_table <- subset(dat_orignal, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))
describeBy(dat_table, group = "beroep", fast=TRUE)
```
</div>
<script>
document.getElementById("showButton3").addEventListener("click", function() {
  var contentContainer3 = document.getElementById("contentContainer3");
  if (contentContainer3.style.display === "none") {
    contentContainer3.style.display = "block";
  } else {
    contentContainer3.style.display = "none";
  }
});
</script>

Results seem to indicate that there are no differences between scenarions or the different occupations and that within the groups there is no general consensus.

# Data -Analysis - Individual Trace Plots (all participants by occupation)
Individual trace graphs will be plotted for amount of memory errors for each legal decision by occupation and their response to the first legal decision. Participants who made no decision are assigned to the number 12 for plotting purposes. The plots need variable lists.

## *Scenario 1 - Misremember colour jacket*
<button id="showButton4">Show Graph Scenario 1</button>

<div id="graphContainer4" style="display:none;">
```{r,  out.height="100%", message=FALSE}
dat_scen <- read_xlsx("Raw_data.xlsx",  skip = 1)
dat_scen <- as.data.frame(dat_scen)
setnames(dat_scen, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_scen, "Wat is uw huidige beroep? - Selected Choice", "beroep")
dat_scen <- subset(dat_scen,dat_scen$Progress==100)
dat_scen[is.na(dat_scen)] <- 12
dat_scen$participants <- seq(1,295,1)
names(dat_scen)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_scen <- dat_scen %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))
dat_scen <- dat_scen %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_scen <- dat_scen %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_scen <- dat_scen %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))

dat_scen$group1  = factor(dat_scen$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen$group2  = factor(dat_scen$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen$group3  = factor(dat_scen$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))

dat_scen$beroep  = factor(dat_scen$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))

first_var_list <- c("x1", "x2", "x3", "x4", "x5", "x6")
second_var_list <- c("x7", "x8", "x9", "x10", "x11", "x12")
third_var_list <- c("x13", "x14", "x15", "x16", "x17", "x18")

scen1 <- plot_trajectories(data = dat_scen,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
  
scen1
```
</div>
<script>
document.getElementById("showButton4").addEventListener("click", function() {
  var graphContainer4 = document.getElementById("graphContainer4");
  if (graphContainer4.style.display === "none") {
    graphContainer4.style.display = "block";
  } else {
    graphContainer4.style.display = "none";
  }
});
</script>


## *Scenario 2 - Misremember entire new detail (i.e., yellow hat)*
<button id="showButton5">Show Graph Scenario 2</button>

<div id="graphContainer5" style="display:none;">
```{r,  out.height="100%", message=FALSE}
scen2 <- plot_trajectories(data = dat_scen,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2

```
</div>
<script>
document.getElementById("showButton5").addEventListener("click", function() {
  var graphContainer5 = document.getElementById("graphContainer5");
  if (graphContainer5.style.display === "none") {
    graphContainer5.style.display = "block";
  } else {
    graphContainer5.style.display = "none";
  }
});
</script>

## *Scenario 3 - Misremember entire new incriminating detail (i.e., black gun)*
<button id="showButton6">Show Graph Scenario 3</button>

<div id="graphContainer6" style="display:none;">
```{r, out.height="100%", message=FALSE}
scen3 <- plot_trajectories(data = dat_scen,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3
```
</div>
<script>
document.getElementById("showButton6").addEventListener("click", function() {
  var graphContainer6 = document.getElementById("graphContainer6");
  if (graphContainer6.style.display === "none") {
    graphContainer6.style.display = "block";
  } else {
    graphContainer6.style.display = "none";
  }
});
</script>

# Data Analysis - Specific Countries

## Summary Statistics by Country of Practice
Dutch, Belgian, and USA participants are put in separate groups. Remaining countries are put together in other.
```{r, echo=FALSE, message=FALSE}
dat_country <- read_xlsx("Raw_data.xlsx",  skip = 1)
dat_country <- as.data.frame(dat_country)
setnames(dat_country, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_country, "Wat is uw huidige beroep? - Selected Choice", "beroep")
dat_country <- subset(dat_country,dat_country$Progress==100)
dat_country$participants <- seq(1,295,1)
names(dat_country)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_country <- dat_country %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))
dat_country <- dat_country %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_country <- dat_country %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_country <- dat_country %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))
dat_country <- dat_country %>% 
  mutate(country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
                      `List of Countries...28`  == "Belgium" ~ "BE",
                      `List of Countries...28`  == "United States of America" ~ "USA",
                      TRUE ~ "Other"))
dat_country$group1  = factor(dat_country$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_country$group2  = factor(dat_country$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_country$group3  = factor(dat_country$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))

dat_country$beroep = factor(dat_country$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))
dat_country$country = factor(dat_country$country, levels=c("NL","BE","USA", "Other"))
```


<button id="showButtonc">Show Summary Stats per Country</button>

<div id="contentContainerc" style="display:none;">

```{r, warning=FALSE}
dat_tab_count <- subset(dat_country, select = c(country,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))
describeBy(dat_tab_count, group = "country", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonc").addEventListener("click", function() {
  var contentContainerc = document.getElementById("contentContainerc");
  if (contentContainerc.style.display === "none") {
    contentContainerc.style.display = "block";
  } else {
    contentContainerc.style.display = "none";
  }
});
</script>

The data seem to be strange as there are many USA legal professionals and other countries. See below for more analyses with stricter exclusion criteria


## The Netherlands/ N = 40
<button id="showButtonnl">Netherlands Summary Statistics</button>

<div id="contentContainernl" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_scen1_NL <- read_xlsx("Raw_data.xlsx",  skip = 1)
dat_scen1_NL <- as.data.frame(dat_scen1_NL)
setnames(dat_scen1_NL, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_scen1_NL, "Wat is uw huidige beroep? - Selected Choice", "beroep")
dat_scen1_NL <- subset(dat_scen1_NL,dat_scen1_NL$Progress==100)
dat_scen1_NL$participants <- seq(1,295,1)
names(dat_scen1_NL)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_scen1_NL <- dat_scen1_NL %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))
dat_scen1_NL <- dat_scen1_NL %>% 
  mutate(country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
                      `List of Countries...28`  == "Belgium" ~ "BE",
                      `List of Countries...28`  == "United States of America" ~ "USA",
                      TRUE ~ "Other"))

dat_scen1_NL$beroep = factor(dat_scen1_NL$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))

dat_scen1_NL <- subset(dat_scen1_NL, dat_scen1_NL$country=="NL")


dat_table_NL <- subset(dat_scen1_NL, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_table_NL, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonnl").addEventListener("click", function() {
  var contentContainernl = document.getElementById("contentContainernl");
  if (contentContainernl.style.display === "none") {
    contentContainernl.style.display = "block";
  } else {
    contentContainernl.style.display = "none";
  }
});
</script>

### Individual Trace Plot NL - Scen 1

<button id="showButtonnl1">Show Graph Scen 1/NL</button>

<div id="graphContainernl1" style="display:none;">
```{r, warning=FALSE}
dat_scen1_NL[is.na(dat_scen1_NL)] <- 12
dat_scen1_NL <- dat_scen1_NL %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_scen1_NL <- dat_scen1_NL %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_scen1_NL <- dat_scen1_NL %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))
dat_scen1_NL$group1  = factor(dat_scen1_NL$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_NL$group2  = factor(dat_scen1_NL$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_NL$group3  = factor(dat_scen1_NL$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))

scen1_nl <- plot_trajectories(data = dat_scen1_NL,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_nl
```
</div>
<script>
document.getElementById("showButtonnl1").addEventListener("click", function() {
  var graphContainernl1 = document.getElementById("graphContainernl1");
  if (graphContainernl1.style.display === "none") {
    graphContainernl1.style.display = "block";
  } else {
    graphContainernl1.style.display = "none";
  }
});
</script>

### Individual Trace Plot NL - Scen 2

<button id="showButtonnl2">Show Graph Scen 2/NL</button>

<div id="graphContainernl2" style="display:none;">
```{r}
scen2_nl <- plot_trajectories(data = dat_scen1_NL,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_nl
```
</div>
<script>
document.getElementById("showButtonnl2").addEventListener("click", function() {
  var graphContainernl2 = document.getElementById("graphContainernl2");
  if (graphContainernl2.style.display === "none") {
    graphContainernl2.style.display = "block";
  } else {
    graphContainernl2.style.display = "none";
  }
});
</script>

### Individual Trace Plot NL - Scen 3

<button id="showButtonnl3">Show Graph Scen 3/NL</button>

<div id="graphContainernl3" style="display:none;">
```{r}
scen_nl3 <- plot_trajectories(data = dat_scen1_NL,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen_nl3
```
</div>
<script>
document.getElementById("showButtonnl3").addEventListener("click", function() {
  var graphContainernl3 = document.getElementById("graphContainernl3");
  if (graphContainernl3.style.display === "none") {
    graphContainernl3.style.display = "block";
  } else {
    graphContainernl3.style.display = "none";
  }
});
</script>


## Belgium/ N = 29
<button id="showButtonbe">Belgium Summary Statistics</button>

<div id="contentContainerbe" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_scen1_BE <- read_xlsx("Raw_data.xlsx",  skip = 1)
dat_scen1_BE <- as.data.frame(dat_scen1_BE)
setnames(dat_scen1_BE, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_scen1_BE, "Wat is uw huidige beroep? - Selected Choice", "beroep")
dat_scen1_BE <- subset(dat_scen1_BE,dat_scen1_BE$Progress==100)
dat_scen1_BE$participants <- seq(1,295,1)
names(dat_scen1_BE)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_scen1_BE <- dat_scen1_BE %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))

dat_scen1_BE <- dat_scen1_BE %>% 
  mutate(country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
                      `List of Countries...28`  == "Belgium" ~ "BE",
                      `List of Countries...28`  == "United States of America" ~ "USA",
                      TRUE ~ "Other"))

dat_scen1_BE$beroep = factor(dat_scen1_BE$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))

dat_scen1_BE <- subset(dat_scen1_BE, dat_scen1_BE$country=="BE")


dat_table_BE <- subset(dat_scen1_BE, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_table_BE, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonbe").addEventListener("click", function() {
  var contentContainerbe = document.getElementById("contentContainerbe");
  if (contentContainerbe.style.display === "none") {
    contentContainerbe.style.display = "block";
  } else {
    contentContainerbe.style.display = "none";
  }
});
</script>

### Individual Trace Plot BE - Scen 1

<button id="showButtonbe1">Show Graph Scen 1/BE</button>

<div id="graphContainerbe1" style="display:none;">
```{r, warning=FALSE}
dat_scen1_BE[is.na(dat_scen1_BE)] <- 12
dat_scen1_BE <- dat_scen1_BE %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_scen1_BE <- dat_scen1_BE %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_scen1_BE <- dat_scen1_BE %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))
dat_scen1_BE$group1  = factor(dat_scen1_BE$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_BE$group2  = factor(dat_scen1_BE$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_BE$group3  = factor(dat_scen1_BE$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))

scen1_be <- plot_trajectories(data = dat_scen1_BE,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_be
```
</div>
<script>
document.getElementById("showButtonbe1").addEventListener("click", function() {
  var graphContainerbe1 = document.getElementById("graphContainerbe1");
  if (graphContainerbe1.style.display === "none") {
    graphContainerbe1.style.display = "block";
  } else {
    graphContainerbe1.style.display = "none";
  }
});
</script>

### Individual Trace Plot BE - Scen 2

<button id="showButtonbe2">Show Graph Scen 2/BE</button>

<div id="graphContainerbe2" style="display:none;">
```{r}
scen2_be <- plot_trajectories(data = dat_scen1_BE,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_be
```
</div>
<script>
document.getElementById("showButtonbe2").addEventListener("click", function() {
  var graphContainerbe2 = document.getElementById("graphContainerbe2");
  if (graphContainerbe2.style.display === "none") {
    graphContainerbe2.style.display = "block";
  } else {
    graphContainerbe2.style.display = "none";
  }
});
</script>

### Individual Trace Plot BE - Scen 3

<button id="showButtonbe3">Show Graph Scen 3/BE</button>

<div id="graphContainerbe3" style="display:none;">
```{r}
scen3_be <- plot_trajectories(data = dat_scen1_BE,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_be
```
</div>
<script>
document.getElementById("showButtonbe3").addEventListener("click", function() {
  var graphContainerbe3 = document.getElementById("graphContainerbe3");
  if (graphContainerbe3.style.display === "none") {
    graphContainerbe3.style.display = "block";
  } else {
    graphContainerbe3.style.display = "none";
  }
});
</script>


## USA/ N = 99
<button id="showButtonUSA">USA Summary Statistics</button>

<div id="contentContainerUSA" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_scen1_USA <- read_xlsx("Raw_data.xlsx",  skip = 1)
dat_scen1_USA <- as.data.frame(dat_scen1_USA)
setnames(dat_scen1_USA, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_scen1_USA, "Wat is uw huidige beroep? - Selected Choice", "beroep")
dat_scen1_USA <- subset(dat_scen1_USA,dat_scen1_USA$Progress==100)
dat_scen1_USA$participants <- seq(1,295,1)
names(dat_scen1_USA)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_scen1_USA <- dat_scen1_USA %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))

dat_scen1_USA <- dat_scen1_USA %>% 
  mutate(country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
                      `List of Countries...28`  == "Belgium" ~ "BE",
                      `List of Countries...28`  == "United States of America" ~ "USA",
                      TRUE ~ "Other"))

dat_scen1_USA$beroep = factor(dat_scen1_USA$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))

dat_scen1_USA <- subset(dat_scen1_USA, dat_scen1_USA$country=="USA")


dat_table_USA <- subset(dat_scen1_USA, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_table_USA, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonUSA").addEventListener("click", function() {
  var contentContainerUSA = document.getElementById("contentContainerUSA");
  if (contentContainerUSA.style.display === "none") {
    contentContainerUSA.style.display = "block";
  } else {
    contentContainerUSA.style.display = "none";
  }
});
</script>

### Individual Trace Plot USA - Scen 1

<button id="showButtonUSA1">Show Graph Scen 1/USA</button>

<div id="graphContainerUSA1" style="display:none;">
```{r, warning=FALSE}
dat_scen1_USA[is.na(dat_scen1_USA)] <- 12
dat_scen1_USA <- dat_scen1_USA %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_scen1_USA <- dat_scen1_USA %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_scen1_USA <- dat_scen1_USA %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))
dat_scen1_USA$group1  = factor(dat_scen1_USA$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_USA$group2  = factor(dat_scen1_USA$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_USA$group3  = factor(dat_scen1_USA$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
scen1_USA <- plot_trajectories(data = dat_scen1_USA,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_USA
```
</div>
<script>
document.getElementById("showButtonUSA1").addEventListener("click", function() {
  var graphContainerUSA1 = document.getElementById("graphContainerUSA1");
  if (graphContainerUSA1.style.display === "none") {
    graphContainerUSA1.style.display = "block";
  } else {
    graphContainerUSA1.style.display = "none";
  }
});
</script>

### Individual Trace Plot USA - Scen 2

<button id="showButtonUSA2">Show Graph Scen 2/USA</button>

<div id="graphContainerUSA2" style="display:none;">
```{r}
scen2_USA <- plot_trajectories(data = dat_scen1_USA,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_USA
```
</div>
<script>
document.getElementById("showButtonUSA2").addEventListener("click", function() {
  var graphContainerUSA2 = document.getElementById("graphContainerUSA2");
  if (graphContainerUSA2.style.display === "none") {
    graphContainerUSA2.style.display = "block";
  } else {
    graphContainerUSA2.style.display = "none";
  }
});
</script>

### Individual Trace Plot USA - Scen 3

<button id="showButtonUSA3">Show Graph Scen 3/USA</button>

<div id="graphContainerUSA3" style="display:none;">
```{r}
scen3_USA <- plot_trajectories(data = dat_scen1_USA,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_USA
```
</div>
<script>
document.getElementById("showButtonUSA3").addEventListener("click", function() {
  var graphContainerUSA3 = document.getElementById("graphContainerUSA3");
  if (graphContainerUSA3.style.display === "none") {
    graphContainerUSA3.style.display = "block";
  } else {
    graphContainerUSA3.style.display = "none";
  }
});
</script>

## Other/ N = 127
<button id="showButtonOT">Other  Summary Statistics</button>

<div id="contentContainerOT" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_scen1_OT <- read_xlsx("Raw_data.xlsx",  skip = 1)
dat_scen1_OT <- as.data.frame(dat_scen1_OT)
setnames(dat_scen1_OT, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_scen1_OT, "Wat is uw huidige beroep? - Selected Choice", "beroep")
dat_scen1_OT <- subset(dat_scen1_OT,dat_scen1_OT$Progress==100)
dat_scen1_OT$participants <- seq(1,295,1)
names(dat_scen1_OT)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_scen1_OT <- dat_scen1_OT %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))

dat_scen1_OT <- dat_scen1_OT %>% 
  mutate(country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
                      `List of Countries...28`  == "Belgium" ~ "BE",
                      `List of Countries...28`  == "United States of America" ~ "USA",
                      TRUE ~ "Other"))

dat_scen1_OT$beroep = factor(dat_scen1_OT$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))

dat_scen1_OT <- subset(dat_scen1_OT, dat_scen1_OT$country=="Other")


dat_table_OT <- subset(dat_scen1_OT, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_table_OT, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonOT").addEventListener("click", function() {
  var contentContainerOT = document.getElementById("contentContainerOT");
  if (contentContainerOT.style.display === "none") {
    contentContainerOT.style.display = "block";
  } else {
    contentContainerOT.style.display = "none";
  }
});
</script>

### Individual Trace Plot Other Countries- Scen 1

<button id="showButtonOT1">Show Graph Scen 1/Other</button>

<div id="graphContainerOT1" style="display:none;">
```{r, warning=FALSE}
dat_scen1_OT[is.na(dat_scen1_OT)] <- 12
dat_scen1_OT <- dat_scen1_OT %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_scen1_OT <- dat_scen1_OT %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_scen1_OT <- dat_scen1_OT %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))
dat_scen1_OT$group1  = factor(dat_scen1_OT$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_OT$group2  = factor(dat_scen1_OT$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_scen1_OT$group3  = factor(dat_scen1_OT$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
scen1_OT <- plot_trajectories(data = dat_scen1_OT,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_OT
```
</div>
<script>
document.getElementById("showButtonOT1").addEventListener("click", function() {
  var graphContainerOT1 = document.getElementById("graphContainerOT1");
  if (graphContainerOT1.style.display === "none") {
    graphContainerOT1.style.display = "block";
  } else {
    graphContainerOT1.style.display = "none";
  }
});
</script>

### Individual Trace Plot Other Countries - Scen 2

<button id="showButtonOT2">Show Graph Scen 2/Other</button>

<div id="graphContainerOT2" style="display:none;">
```{r}
scen2_OT <- plot_trajectories(data = dat_scen1_OT,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_OT
```
</div>
<script>
document.getElementById("showButtonOT2").addEventListener("click", function() {
  var graphContainerOT2 = document.getElementById("graphContainerOT2");
  if (graphContainerOT2.style.display === "none") {
    graphContainerOT2.style.display = "block";
  } else {
    graphContainerOT2.style.display = "none";
  }
});
</script>

### Individual Trace Plot Other Countries - Scen 3

<button id="showButtonOT3">Show Graph Scen 3/Other</button>

<div id="graphContainerOT3" style="display:none;">
```{r}
scen3_OT <- plot_trajectories(data = dat_scen1_OT,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_OT
```
</div>
<script>
document.getElementById("showButtonOT3").addEventListener("click", function() {
  var graphContainerOT3 = document.getElementById("graphContainerOT3");
  if (graphContainerOT3.style.display === "none") {
    graphContainerOT3.style.display = "block";
  } else {
    graphContainerOT3.style.display = "none";
  }
});
</script>


# Data Analyses with strict exclusion criteria
  - Upon visual inspection of the data, some data points seem off (e.g., could be bots) 
    + Many participants from the United States (survey was in dutch)
    + Some participants with more years of practice than age/years of practice improbable
    + Some participants completed the study very fast.
    
Hence, analyses are run with more strict exclusion criteria to see whether similar pattern of resuts remain.
  
## Exclusion criteria
  - Participants who's years of experience indicated that they started their legal career before the age of 18.
  - Participants who indicated to currently be a "judge" but have less than 5 years experience in the legal system.
  - Participants who took less than 300 seconds (5min) to complete survey (decision arbitrary but judged to be too fast).
  
<button id="showButtonEX">Summary Statistics Exluded by Country</button>

<div id="contentContainerEX" style="display:none;">
```{r, warning=FALSE, message=FALSE}
dat_exclusion <- read_xlsx("Raw_data.xlsx",  skip = 1)
dat_exclusion <- as.data.frame(dat_exclusion)
setnames(dat_exclusion, "Wat is de achtergrond van uw huidige beroep? - Selected Choice", "background")
setnames(dat_exclusion, "Wat is uw huidige beroep? - Selected Choice", "beroep")
names(dat_exclusion)[29:46] <- c("x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18")
dat_exclusion <- dat_exclusion %>% 
  mutate(beroep = case_when(beroep == "Rechter"  ~ "Judge",
                            beroep == "(substituut) Procureur des konings/officier van justitie"  ~ "Prosecutor",
                            beroep == "Advocaat"  ~ "Lawyer",
                            beroep == "Jurist"  ~ "Parelegal",
                            beroep == "Anders (graag specificeren):\n"  ~ "Other"))
dat_exclusion <- subset(dat_exclusion,dat_exclusion$Progress==100)
dat_exclusion$participants <- seq(1,295,1)
dat_exclusion[is.na(dat_exclusion)] <- 12
#Exclusions strict
dat_exclusion <- subset(dat_exclusion, dat_exclusion$`Leeftijd (in jaren)`- dat_exclusion$`Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` > 18)
dat_exclusion <- subset(dat_exclusion,!(dat_exclusion$`Hoeveel jaren werkt u ongeveer al in het rechtssysteem?` < 5 & dat_exclusion$beroep=="Judge"))
dat_exclusion <- subset(dat_exclusion, dat_exclusion$`Duration (in seconds)` > 300)


dat_exclusion <- dat_exclusion %>% 
  mutate(group1 = case_when(x1 < 2.5 ~ "Low",
                         x1 >=2.5 & x1 <5.0 ~ "Medium-low",
                         x1 >=5.0 & x1 <7.5 ~ "Medium-high",
                         x1 >= 7.5 & x1 <=10~ "High",
                         x1 > 10 ~ "No-decision"))
dat_exclusion <- dat_exclusion %>% 
  mutate(group2 = case_when(x7 < 2.5 ~ "Low",
                         x7 >=2.5 & x7 <5.0 ~ "Medium-low",
                         x7 >=5.0 & x7 <7.5 ~ "Medium-high",
                         x7 >= 7.5 & x7 <=10~ "High",
                         x7 > 10 ~ "No-decision"))
dat_exclusion <- dat_exclusion %>% 
  mutate(group3 = case_when(x13 < 2.5 ~ "Low",
                         x13 >=2.5 & x13 <5.0 ~ "Medium-low",
                         x13 >=5.0 & x13 <7.5 ~ "Medium-high",
                         x13 >= 7.5 & x13 <=10~ "High",
                         x13 > 10 ~ "No-decision"))
dat_exclusion <- dat_exclusion %>% 
  mutate(country = case_when(`List of Countries...28` == "Netherlands" ~ "NL",
                      `List of Countries...28`  == "Belgium" ~ "BE",
                      `List of Countries...28`  == "United States of America" ~ "USA",
                      TRUE ~ "Other"))


dat_exclusion$group1  = factor(dat_exclusion$group1, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_exclusion$group2  = factor(dat_exclusion$group2, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))
dat_exclusion$group3  = factor(dat_exclusion$group3, levels=c("Low", "Medium-low", "Medium-high", "High", "No-decision"))

dat_exclusion$beroep  = factor(dat_exclusion$beroep, levels=c("Judge", "Prosecutor", "Lawyer", "Parelegal", "Other"))

dat_table_EX <- subset(dat_exclusion, select = c(beroep, country, x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_table_EX, group="country", fast=TRUE)

```
</div>
<script>
document.getElementById("showButtonEX").addEventListener("click", function() {
  var contentContainerEX = document.getElementById("contentContainerEX");
  if (contentContainerEX.style.display === "none") {
    contentContainerEX.style.display = "block";
  } else {
    contentContainerEX.style.display = "none";
  }
});
</script>


<button id="showButtonEXoc">Summary Statistics Excluded by Occupation</button>

<div id="contentContainerEXoc" style="display:none;">
```{r, warning=FALSE, message=FALSE}
dat_table_EX <- subset(dat_exclusion, select = c(beroep, country, x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_table_EX, group="beroep", fast=TRUE)

```
</div>
<script>
document.getElementById("showButtonEXoc").addEventListener("click", function() {
  var contentContainerEXoc = document.getElementById("contentContainerEXoc");
  if (contentContainerEXoc.style.display === "none") {
    contentContainerEXoc.style.display = "block";
  } else {
    contentContainerEXoc.style.display = "none";
  }
});
</script>


### Individual trace plots - Scen 1 - Strict Exclusion data

<button id="showButtonEX1">Show Graph Scen 1/Other</button>

<div id="graphContainerEX1" style="display:none;">
```{r}
scen1_EX <- plot_trajectories(data = dat_exclusion,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_EX
```
</div>
<script>
document.getElementById("showButtonEX1").addEventListener("click", function() {
  var graphContainerEX1 = document.getElementById("graphContainerEX1");
  if (graphContainerEX1.style.display === "none") {
    graphContainerEX1.style.display = "block";
  } else {
    graphContainerEX1.style.display = "none";
  }
});
</script>


### Individual trace plots - Scen 2 - Strict Exclusion data

<button id="showButtonEX2">Show Graph Scen 2/Other</button>

<div id="graphContainerEX2" style="display:none;">
```{r}
scen2_EX <- plot_trajectories(data = dat_exclusion,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_EX
```
</div>
<script>
document.getElementById("showButtonEX2").addEventListener("click", function() {
  var graphContainerEX2 = document.getElementById("graphContainerEX2");
  if (graphContainerEX2.style.display === "none") {
    graphContainerEX2.style.display = "block";
  } else {
    graphContainerEX2.style.display = "none";
  }
});
</script>


### Individual trace plots - Scen 3 - Strict Exclusion data

<button id="showButtonEX3">Show Graph Scen 3/Other</button>

<div id="graphContainerEX3" style="display:none;">
```{r}
scen3_EX <- plot_trajectories(data = dat_exclusion,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_EX
```
</div>
<script>
document.getElementById("showButtonEX3").addEventListener("click", function() {
  var graphContainerEX3 = document.getElementById("graphContainerEX3");
  if (graphContainerEX3.style.display === "none") {
    graphContainerEX3.style.display = "block";
  } else {
    graphContainerEX3.style.display = "none";
  }
});
</script>


# Data Analysis Data with strict exclusion - Specific Countries

## The Netherlands/ N = 40
<button id="showButtonnlex">Netherlands Summary Statistics</button>

<div id="contentContainernlex" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_exclusion_nl <- dat_exclusion
dat_exclusion_nl <- subset(dat_exclusion_nl, dat_exclusion_nl$country=="NL")

dat_table_ex_nl <- subset(dat_exclusion_nl, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_table_ex_nl, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonnlex").addEventListener("click", function() {
  var contentContainernlex = document.getElementById("contentContainernlex");
  if (contentContainernlex.style.display === "none") {
    contentContainernlex.style.display = "block";
  } else {
    contentContainernlex.style.display = "none";
  }
});
</script>

### Individual Trace Plot NL - Scen 1

<button id="showButtonnlex1">Show Graph Scen 1/NL</button>

<div id="graphContainernlex1" style="display:none;">
```{r, warning=FALSE}

scen1_nl_ex <- plot_trajectories(data = dat_exclusion_nl,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_nl_ex
```
</div>
<script>
document.getElementById("showButtonnlex1").addEventListener("click", function() {
  var graphContainernlex1 = document.getElementById("graphContainernlex1");
  if (graphContainernlex1.style.display === "none") {
    graphContainernlex1.style.display = "block";
  } else {
    graphContainernlex1.style.display = "none";
  }
});
</script>

### Individual Trace Plot NL - Scen 2

<button id="showButtonnlex2">Show Graph Scen 2/NL</button>

<div id="graphContainernlex2" style="display:none;">
```{r}
scen2_nl_ex <- plot_trajectories(data = dat_exclusion_nl,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_nl_ex
```
</div>
<script>
document.getElementById("showButtonnlex2").addEventListener("click", function() {
  var graphContainernlex2 = document.getElementById("graphContainernlex2");
  if (graphContainernlex2.style.display === "none") {
    graphContainernlex2.style.display = "block";
  } else {
    graphContainernlex2.style.display = "none";
  }
});
</script>

### Individual Trace Plot NL - Scen 3

<button id="showButtonnlex3">Show Graph Scen 3/NL</button>

<div id="graphContainernlex3" style="display:none;">
```{r}
scen3_nl_ex <- plot_trajectories(data = dat_exclusion_nl,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_nl_ex
```
</div>
<script>
document.getElementById("showButtonnlex3").addEventListener("click", function() {
  var graphContainernlex3 = document.getElementById("graphContainernlex3");
  if (graphContainernlex3.style.display === "none") {
    graphContainernlex3.style.display = "block";
  } else {
    graphContainernlex3.style.display = "none";
  }
});
</script>


## Belgium/ N = 23
<button id="showButtonbeex">Belgium Summary Statistics</button>

<div id="contentContainerbeex" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_exclusion_be <- dat_exclusion
dat_exclusion_be <- subset(dat_exclusion_be, dat_exclusion_be$country=="BE")

dat_tab_ex_be <- subset(dat_exclusion_be, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_tab_ex_be, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonbeex").addEventListener("click", function() {
  var contentContainerbeex = document.getElementById("contentContainerbeex");
  if (contentContainerbeex.style.display === "none") {
    contentContainerbeex.style.display = "block";
  } else {
    contentContainerbeex.style.display = "none";
  }
});
</script>

### Individual Trace Plot BE - Scen 1

<button id="showButtonbeex1">Show Graph Scen 1/BE</button>

<div id="graphContainerbeex1" style="display:none;">
```{r, warning=FALSE}
scen1_be_ex <- plot_trajectories(data = dat_exclusion_be,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_be_ex
```
</div>
<script>
document.getElementById("showButtonbeex1").addEventListener("click", function() {
  var graphContainerbeex1 = document.getElementById("graphContainerbeex1");
  if (graphContainerbeex1.style.display === "none") {
    graphContainerbeex1.style.display = "block";
  } else {
    graphContainerbeex1.style.display = "none";
  }
});
</script>

### Individual Trace Plot BE - Scen 2

<button id="showButtonbeex2">Show Graph Scen 2/BE</button>

<div id="graphContainerbeex2" style="display:none;">
```{r}
scen2_be_ex <- plot_trajectories(data = dat_exclusion_be,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_be_ex
```
</div>
<script>
document.getElementById("showButtonbeex2").addEventListener("click", function() {
  var graphContainerbeex2 = document.getElementById("graphContainerbeex2");
  if (graphContainerbeex2.style.display === "none") {
    graphContainerbeex2.style.display = "block";
  } else {
    graphContainerbeex2.style.display = "none";
  }
});
</script>

### Individual Trace Plot BE - Scen 3

<button id="showButtonbeex3">Show Graph Scen 3/BE</button>

<div id="graphContainerbeex3" style="display:none;">
```{r}
scen3_be_ex <- plot_trajectories(data = dat_exclusion_be,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_be_ex
```
</div>
<script>
document.getElementById("showButtonbeex3").addEventListener("click", function() {
  var graphContainerbeex3 = document.getElementById("graphContainerbeex3");
  if (graphContainerbeex3.style.display === "none") {
    graphContainerbeex3.style.display = "block";
  } else {
    graphContainerbeex3.style.display = "none";
  }
});
</script>


## USA/ N = 76
<button id="showButtonUSAex">USA Summary Statistics</button>

<div id="contentContainerUSAex" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_exclusion_USA <- dat_exclusion
dat_exclusion_USA <- subset(dat_exclusion_USA, dat_exclusion_USA$country=="USA")

dat_tab_ex_USA <- subset(dat_exclusion_USA, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_tab_ex_USA, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonUSAex").addEventListener("click", function() {
  var contentContainerUSAex = document.getElementById("contentContainerUSAex");
  if (contentContainerUSAex.style.display === "none") {
    contentContainerUSAex.style.display = "block";
  } else {
    contentContainerUSAex.style.display = "none";
  }
});
</script>

### Individual Trace Plot USA - Scen 1

<button id="showButtonUSAex1">Show Graph Scen 1/USA</button>

<div id="graphContainerUSAex1" style="display:none;">
```{r, warning=FALSE}
scen1_USA_ex <- plot_trajectories(data = dat_exclusion_USA,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_USA_ex
```
</div>
<script>
document.getElementById("showButtonUSAex1").addEventListener("click", function() {
  var graphContainerUSAex1 = document.getElementById("graphContainerUSAex1");
  if (graphContainerUSAex1.style.display === "none") {
    graphContainerUSAex1.style.display = "block";
  } else {
    graphContainerUSAex1.style.display = "none";
  }
});
</script>

### Individual Trace Plot USA - Scen 2

<button id="showButtonUSAex2">Show Graph Scen 2/USA</button>

<div id="graphContainerUSAex2" style="display:none;">
```{r}
scen2_USA_ex <- plot_trajectories(data = dat_exclusion_USA,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_USA_ex
```
</div>
<script>
document.getElementById("showButtonUSAex2").addEventListener("click", function() {
  var graphContainerUSAex2 = document.getElementById("graphContainerUSAex2");
  if (graphContainerUSAex2.style.display === "none") {
    graphContainerUSAex2.style.display = "block";
  } else {
    graphContainerUSAex2.style.display = "none";
  }
});
</script>

### Individual Trace Plot USA - Scen 3

<button id="showButtonUSAex3">Show Graph Scen 3/USA</button>

<div id="graphContainerUSAex3" style="display:none;">
```{r}
scen3_USA_ex <- plot_trajectories(data = dat_exclusion_USA,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_USA_ex
```
</div>
<script>
document.getElementById("showButtonUSAex3").addEventListener("click", function() {
  var graphContainerUSAex3 = document.getElementById("graphContainerUSAex3");
  if (graphContainerUSAex3.style.display === "none") {
    graphContainerUSAex3.style.display = "block";
  } else {
    graphContainerUSAex3.style.display = "none";
  }
});
</script>

## Other Countries/ N = 73
<button id="showButtonotex">Other countries Summary Statistics</button>

<div id="contentContainerotex" style="display:none;">

```{r, message=FALSE, warning=FALSE}
dat_exclusion_ot <- dat_exclusion
dat_exclusion_ot <- subset(dat_exclusion_ot, dat_exclusion_ot$country=="Other")

dat_tab_ex_ot <- subset(dat_exclusion_ot, select = c(beroep,x1,x2,x3,x4,x5,x6,x7,x8,x9,x10,x11,x12,x13,x14,x15,x16,x17,x18))

describeBy(dat_tab_ex_ot, group="beroep", fast=TRUE)
```

</div>
<script>
document.getElementById("showButtonotex").addEventListener("click", function() {
  var contentContainerotex = document.getElementById("contentContainerotex");
  if (contentContainerotex.style.display === "none") {
    contentContainerotex.style.display = "block";
  } else {
    contentContainerotex.style.display = "none";
  }
});
</script>

### Individual Trace Plot Other - Scen 1

<button id="showButtonotex1">Show Graph Scen 1/Other</button>

<div id="graphContainerotex1" style="display:none;">
```{r, warning=FALSE}
scen1_ot_ex <- plot_trajectories(data = dat_exclusion_ot,
                  id_var = "participants", 
                  var_list = first_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group1)
scen1_ot_ex
```
</div>
<script>
document.getElementById("showButtonotex1").addEventListener("click", function() {
  var graphContainerotex1 = document.getElementById("graphContainerotex1");
  if (graphContainerotex1.style.display === "none") {
    graphContainerotex1.style.display = "block";
  } else {
    graphContainerotex1.style.display = "none";
  }
});
</script>

### Individual Trace Plot Other - Scen 2

<button id="showButtonotex2">Show Graph Scen 2/Other</button>

<div id="graphContainerotex2" style="display:none;">
```{r}
scen2_ot_ex <- plot_trajectories(data = dat_exclusion_ot,
                  id_var = "participants", 
                  var_list = second_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group2)
scen2_ot_ex
```
</div>
<script>
document.getElementById("showButtonotex2").addEventListener("click", function() {
  var graphContainerotex2 = document.getElementById("graphContainerotex2");
  if (graphContainerotex2.style.display === "none") {
    graphContainerotex2.style.display = "block";
  } else {
    graphContainerotex2.style.display = "none";
  }
});
</script>

### Individual Trace Plot Other - Scen 3

<button id="showButtonotex3">Show Graph Scen 3/Other</button>

<div id="graphContainerotex3" style="display:none;">
```{r}
scen3_ot_ex <- plot_trajectories(data = dat_exclusion_ot,
                  id_var = "participants", 
                  var_list = third_var_list,
                  xlab = "Items", ylab = "Amount of errors",
                  connect_missing = FALSE, 
                  random_sample_frac = 1, 
                  title_n = TRUE)+
  facet_wrap(~beroep+group3)
scen3_ot_ex
```
</div>
<script>
document.getElementById("showButtonotex3").addEventListener("click", function() {
  var graphContainerotex3 = document.getElementById("graphContainerotex3");
  if (graphContainerotex3.style.display === "none") {
    graphContainerotex3.style.display = "block";
  } else {
    graphContainerotex3.style.display = "none";
  }
});
</script>